<div class="activity-grouping">
  [% if let Some(ref activity) = self.0.activity.iter().map(|a| a.borrow()).next() { %]
  <a href="[% activity as URL %]" class="activity[%
     for c in activity.prereq_concepts.iter().map(|c| c.borrow()) {
     %] from-[% c.id } %]" id="[% activity.id %]">
    <div class="activity" thisid="[% activity.id %]" name="name">[% activity.name %]</div>
    <div class="hint"><br/></div>
    <div class="description hint" thisid="[% activity.id %]" name="long_description">
      [% activity.long_description %]
    </div>[%
    for r in activity.representations.iter() { %]
    <div onclick="document.location.href ='[% r.0 as URL %]'; return false"
         style="cursor: pointer;"
         class="representation">
      representation.icon
    </div>
    [% } %]
  </a>[%
  } else { %]
  <a href="/activity/orphans" class="activity orphans" id="orphans">
    <div class="activity orphans">ORPHANS!</div>
  </a> [%
  } %]
  <div class="concepts">
    [% for concept in self.0.concepts.iter().map(|c| c.borrow()) { %]
    <a href="[% concept as URL %]" class="concept[%
       for a in concept.activities.iter().map(|a| a.borrow()) {
       %] from-[% a.id } %]" id="[% concept.id %]">
      [% for r in concept.representations.iter() { %]
      <div onclick="document.location.href ='[% r.0 as URL %]'; return false"
           style="cursor: pointer;"
           class="representation">
        r.icon
      </div>
      [% }
      %]<span thisid="[% concept.id %]" name="name">[% concept.name %]</span>
      <div class="description hint" thisid="[% concept.id %]" name="long_description">
        <br/>
        [% concept.long_description %]
      </div>
    </a>
    [% } %]
  </div>
</div>
